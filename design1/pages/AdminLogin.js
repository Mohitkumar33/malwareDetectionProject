// import { useAuth } from "@/components/context/auth-context";
import { useState } from "react";
import { useRouter } from "next/router";
// import api from "../utilities/apiConfig"; // Import your Axios instance
import { useToast } from "@chakra-ui/react";
import api from "../utilities/apiConfig";
import Navigation from "@/components/Navigation";
import LargeWithLogoLeft from "@/components/Footer";
import { useAuth } from "@/components/context/auth-context";

const AdminLogin = () => {
  const router = useRouter();
  const [emailInput, setEmailInput] = useState("");
  const [passwordInput, setPasswordInput] = useState("");
  const { authState, setAuthState } = useAuth();
  const toast = useToast();

  const loginApi = async (email, password) => {
    try {
      const { data } = await api.post("/api/users/login", {
        email: email,
        password: password,
      });
      console.log(data);
      // localStorage.setItem("token", data.token);
      localStorage.setItem("name", data.name);
      localStorage.setItem("type", data.userType);
      // localStorage.setItem("email", data.email);
      // localStorage.setItem("adminId", data.adminId);
      setAuthState({
        isAuth: true,
        userInfo: data.name,
      });
      router.push("/dashboard/HomePage");
      toast({
        title: "Success",
        description: "Login Successful",
        status: "success",
        position: "top-right",
        duration: 2000,
        isClosable: true,
      });
    } catch (error) {
      console.log(error, "this is error");
      toast({
        title: "Error",
        description: "Something went wrong",
        status: "error",
        position: "top-right",
        duration: 2000,
        isClosable: true,
      });
    }
  };
  //   console.log(authState, "this is auth state");
  return (
    <div>
      <Navigation />
      <h1
        style={{
          textAlign: "center",
          marginBottom: "1rem",
          fontSize: "1.5rem",
          fontWeight: "700",
        }}
      >
        Admin Login
      </h1>

      <div style={{ textAlign: "center" }}>
        <div>Email:</div>
        <input
          onChange={(e) => setEmailInput(e.target.value)}
          style={{ border: "1px solid black" }}
        />
        <div>Password:</div>
        <input
          onChange={(e) => setPasswordInput(e.target.value)}
          type="password"
          style={{ border: "1px solid black" }}
        />
        <br />
        <button
          style={{
            border: "1px solid black",
            marginTop: "1rem",
            marginBottom: "1rem",
          }}
          onClick={() => loginApi(emailInput, passwordInput)}
        >
          Submit
        </button>
      </div>
      <LargeWithLogoLeft />
    </div>
  );
};

export default AdminLogin;
